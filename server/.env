# ╔══════════════════════════════════════════════════════════════╗
# ║              GHOSTY Auth — Environment Variables             ║
# ║                      server/.env                            ║
# ╚══════════════════════════════════════════════════════════════╝
#
# Copy this file to .env and fill in all values.
# NEVER commit .env to version control.
# See docs/setup.md for detailed instructions.
#
# Generate secrets quickly:
#   node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"

# ─── Runtime ──────────────────────────────────────────────────────────────────

NODE_ENV=development
PORT=3000
HOST=0.0.0.0

# ─── PostgreSQL ───────────────────────────────────────────────────────────────

DB_HOST=localhost
DB_PORT=5432
DB_NAME=ghosty_auth
DB_USER=ghosty
DB_PASSWORD=change_me_strong_password

# Enable SSL in production (set to true)
DB_SSL=false

# Connection pool
DB_POOL_MIN=2
DB_POOL_MAX=10
DB_POOL_ACQUIRE_MS=30000
DB_POOL_IDLE_MS=10000

# Log raw SQL queries (dev only — never enable in production)
DB_LOG_QUERIES=false

# ─── Redis ────────────────────────────────────────────────────────────────────

REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# Enable TLS for Redis in production (set to true)
REDIS_TLS=false

# Prefix applied to all Redis keys (change if sharing a Redis instance)
REDIS_KEY_PREFIX=ghosty:

REDIS_CONNECT_TIMEOUT_MS=5000
REDIS_COMMAND_TIMEOUT_MS=3000

# ─── JWT (RS256) ──────────────────────────────────────────────────────────────
#
# Generate a 2048-bit RSA key pair:
#
#   openssl genpkey -algorithm RSA -out private.pem -pkeyopt rsa_keygen_bits:2048
#   openssl rsa -pubout -in private.pem -out public.pem
#
# Then convert to single-line format for .env:
#   awk 'NF {sub(/\r/, ""); printf "%s\\n",$0;}' private.pem
#   awk 'NF {sub(/\r/, ""); printf "%s\\n",$0;}' public.pem
#
# Paste the output (including -----BEGIN ... and -----END ...) below.

JWT_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\nPASTE_YOUR_PRIVATE_KEY_HERE\n-----END PRIVATE KEY-----"
JWT_PUBLIC_KEY="-----BEGIN PUBLIC KEY-----\nPASTE_YOUR_PUBLIC_KEY_HERE\n-----END PUBLIC KEY-----"

# Session token TTL: 1h | 30m | 2h | 7d
JWT_EXPIRES_IN=1h

# ─── Security ─────────────────────────────────────────────────────────────────
#
# HMAC secret — used to sign API responses so SDKs can verify them.
# Must be at least 64 hex characters (32 bytes of entropy).
# Generate: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"

HMAC_SECRET=REPLACE_WITH_64_CHAR_HEX_STRING_AT_LEAST_32_BYTES

# bcrypt work factor — minimum 12 for production, 10 for dev (faster tests)
BCRYPT_ROUNDS=12

# Max age of a signed request before it is rejected (anti-replay)
REQUEST_TIMESTAMP_TOLERANCE_MS=30000

# ─── Rate Limiting ────────────────────────────────────────────────────────────

RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_AUTH=10
RATE_LIMIT_MAX_KEYS=30
RATE_LIMIT_MAX_GENERAL=100

# ─── Admin ────────────────────────────────────────────────────────────────────
#
# If set, POST /users/register requires this key in the request body.
# Prevents public registration. Leave empty to allow open registration.
# Generate: node -e "console.log(require('crypto').randomBytes(24).toString('hex'))"

ADMIN_REGISTRATION_KEY=REPLACE_WITH_RANDOM_SECRET_OR_LEAVE_EMPTY

# ─── CORS ─────────────────────────────────────────────────────────────────────
#
# Comma-separated list of allowed origins for the dashboard.
# Use * for development (allows all origins).
# Example: https://dash.yourdomain.com,https://yourdomain.com

CORS_ORIGIN=*
